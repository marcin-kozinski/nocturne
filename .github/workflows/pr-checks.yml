name: PR Checks

on: pull_request

# Cancel in-progress/pending PR checks if a new commit is pushed to the branch.
concurrency:
  group: ${{ github.workflow }}-${{ github.ref_name }}
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
      - name: Set up environment
        uses: ./.github/actions/setup-environment
        with:
          gradle: true
          hardware-acceleration: true
      - name: Build app
        run: ./scripts/build-app.sh
      - name: Run unit tests
        run: ./scripts/run-unit-tests.sh
      - name: Run UI tests
        run: ./scripts/run-ui-tests.sh
      - name: Run Android Lint
        run: ./scripts/run-android-lint.sh

  check-code-format:
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
      - name: Set up environment
        uses: ./.github/actions/setup-environment
        with:
          ktfmt: true
      - name: Check code formatting
        run: ./scripts/check-code-format.sh

  check-dependencies:
    runs-on: ubuntu-24.04
    steps:
      - name: Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
      - name: Set up environment
        uses: ./.github/actions/setup-environment
        with:
          gradle: true
      - name: Check dependencies
        run: ./scripts/check-dependencies.sh
